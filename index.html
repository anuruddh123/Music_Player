<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Music Player</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet" />
<style>
:root{
  --spotify:#1db954;            /* primary green */
  --spotify-dark:#121212;       /* app bg */
  --card:#181818;               /* card bg */
  --stroke:rgba(255,255,255,.12);
  --text:#e5e7eb;
  --muted:#a1a1aa;
  --accent:#1ed760;             /* brighter green */
}
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%}
body{
  font-family:Poppins,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu;
  background:
    radial-gradient(900px 600px at -10% -10%, rgba(29,185,84,.18), transparent 60%),
    radial-gradient(1000px 700px at 120% 0%, rgba(30,215,96,.14), transparent 60%),
    linear-gradient(180deg, var(--spotify-dark), #0b0b0b 60%);
  color:var(--text);
  min-height:100dvh; display:grid; place-items:center; perspective:1000px; overflow:hidden; padding:16px;
}

/* floating soft glow blobs */
.blob{position:fixed; filter:blur(80px); opacity:.35; mix-blend-mode:screen; pointer-events:none; z-index:0}
.blob.g1{width:420px;height:420px; left:-120px; top:-120px; background:radial-gradient(var(--spotify), transparent 60%); animation:dr1 18s ease-in-out infinite}
.blob.g2{width:420px;height:420px; right:-120px; bottom:-160px; background:radial-gradient(var(--accent), transparent 60%); animation:dr2 22s ease-in-out infinite}
@keyframes dr1{50%{transform:translate(40px,50px) scale(1.06)}}
@keyframes dr2{50%{transform:translate(-40px,-40px) scale(1.05)}}

/* Shell */
.app{
  width:min(1100px, 96vw);
  background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
  border:1px solid var(--stroke); border-radius:24px; padding:16px;
  box-shadow: inset 0 0 0 1px rgba(255,255,255,.04), 0 30px 80px rgba(0,0,0,.6);
  display:grid; grid-template-columns: 1fr auto; gap:16px;
  transform-style:preserve-3d; position:relative; z-index:1; animation:float 8s ease-in-out infinite;
}
@keyframes float{50%{transform:translateY(-10px) rotateY(-2deg)}}
.app.tilt{transition:transform .12s ease-out}

/* Left main panel */
.main{
  background:var(--card); border:1px solid var(--stroke); border-radius:18px; padding:14px; display:grid; gap:14px;
}

/* Header with playlist toggle */
.header{ display:flex; align-items:center; justify-content:space-between; gap:12px; }
.brand{ display:flex; align-items:center; gap:10px; }
.logo{
  width:40px;height:40px;border-radius:12px; display:grid;place-items:center;
  background:linear-gradient(135deg, var(--spotify), var(--accent)); color:#000; font-weight:900; letter-spacing:.5px;
  box-shadow:0 10px 24px rgba(29,185,84,.35);
}
.playlistBtn{
  display:inline-flex; align-items:center; gap:10px; padding:10px 14px; border-radius:12px; cursor:pointer;
  background:#222; border:1px solid var(--stroke); color:var(--text);
  transition:transform .12s ease, box-shadow .2s ease, background .2s ease;
}
.playlistBtn:hover{transform:translateZ(20px) scale(1.04); background:#242424}
.playlistBtn:active{transform:translateZ(8px) scale(.98)}

/* Artwork + vinyl */
.art{
  position:relative; border-radius:16px; overflow:hidden; height:340px;
  box-shadow:0 16px 40px rgba(0,0,0,.55);
}
.art img{width:100%;height:100%;object-fit:cover;display:block; transition:opacity .35s ease}
.art img.fade{opacity:.2}
.vinyl{
  position:absolute; right:-30px; bottom:-30px; width:230px;height:230px;border-radius:50%;
  background:radial-gradient(circle at 50% 50%, #111 0 42%, #000 44% 100%);
  border:2px solid rgba(255,255,255,.06); box-shadow:inset 0 0 0 2px rgba(255,255,255,.04), 0 10px 40px rgba(0,0,0,.6);
  transform:translateZ(40px);
}
.vinyl.spin{animation:spin 6s linear infinite} @keyframes spin{to{transform:translateZ(40px) rotate(360deg)}}
.eq{ position:absolute; left:12px; bottom:12px; display:flex; gap:6px }
.eq span{ width:6px;height:18px;border-radius:6px;background:linear-gradient(var(--spotify), transparent); transform-origin:bottom; opacity:.9; animation:eq 1.2s ease-in-out infinite }
.eq span:nth-child(2){animation-delay:.1s} .eq span:nth-child(3){animation-delay:.2s} .eq span:nth-child(4){animation-delay:.3s}
@keyframes eq{50%{transform:scaleY(2.2)}}

/* Title row */
.title{ display:flex; align-items:center; justify-content:space-between; gap:10px; min-width:0; }
.title h1{ font-size:1.35rem; font-weight:800; overflow:hidden; text-overflow:ellipsis; white-space:nowrap }
.meta{ color:var(--muted); overflow:hidden; text-overflow:ellipsis; white-space:nowrap }
.badge{ padding:6px 10px; border-radius:999px; border:1px solid var(--stroke); font-size:.78rem; color:#d1fae5; background:rgba(29,185,84,.12) }

/* Seekbar */
.seek{ background:#202020; border:1px solid var(--stroke); border-radius:999px; height:12px; position:relative; overflow:hidden; cursor:pointer; }
.progress{ height:100%; width:0%; background:linear-gradient(90deg, var(--spotify), var(--accent)); box-shadow:0 0 20px rgba(30,215,96,.35) }
.thumb{ position:absolute; top:50%; left:0%; transform:translate(-50%,-50%); width:14px;height:14px;border-radius:50%; background:#fff; box-shadow:0 0 14px rgba(255,255,255,.8) }
.timeRow{ display:flex; justify-content:space-between; font-size:.84rem; color:var(--muted) }

/* Controls row */
.controls{ display:flex; align-items:center; justify-content:space-between; gap:12px; background:#151515; border:1px solid var(--stroke); border-radius:14px; padding:10px 12px; }
.btns{ display:flex; align-items:center; gap:10px; flex-wrap:wrap }
.btn{ width:46px;height:46px; display:grid; place-items:center; border-radius:12px; background:#222; color:#eee; border:1px solid var(--stroke); cursor:pointer; transition:transform .12s ease, background .2s ease, box-shadow .2s ease }
.btn:hover{ transform:translateZ(16px) scale(1.04); background:#262626 }
.btn:active{ transform:translateZ(8px) scale(.98) }

/* Premium Play Button */
.play{ width:58px;height:58px; border-radius:14px; background:linear-gradient(180deg, #1ed760, #1db954); color:#0a0a0a; font-weight:800; border:0; box-shadow:0 10px 24px rgba(29,185,84,.35); }
.play svg{ width:28px; height:28px; fill:#0a0a0a; }

.rightCtl{ display:flex; align-items:center; gap:14px; flex-wrap:wrap; justify-content:flex-end }
.vol{ display:flex; align-items:center; gap:8px; min-width:180px }
.range{ -webkit-appearance:none; appearance:none; width:160px; height:8px; border-radius:999px; background:#2a2a2a; border:1px solid var(--stroke); outline:none; overflow:hidden }
.range::-webkit-slider-thumb{ -webkit-appearance:none; appearance:none; width:18px;height:18px;border-radius:50%; background:#fff; box-shadow:-160px 0 0 160px var(--spotify), 0 0 14px rgba(255,255,255,.7) }

.tgl{ display:inline-grid; grid-auto-flow:column; align-items:center; gap:8px; cursor:pointer; color:var(--muted) }
.tgl input{ display:none }
.switch{ width:54px;height:28px;border-radius:999px; position:relative; background:#2a2a2a; border:1px solid var(--stroke) }
.knob{ position:absolute; top:50%; left:4px; transform:translateY(-50%); width:20px;height:20px;border-radius:50%; background:#fff; box-shadow:0 6px 16px rgba(0,0,0,.35); transition:left .18s ease }
input:checked + .switch{ background:linear-gradient(90deg, var(--spotify), var(--accent)) }
input:checked + .switch .knob{ left:30px }

/* Drawer (Playlist) */
.drawer{ position:relative; width:min(380px, 88vw); background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02)); border:1px solid var(--stroke); border-radius:18px; padding:12px; overflow:hidden; height:auto; backdrop-filter: blur(10px); }
.drawerHeader{ display:flex; align-items:center; justify-content:space-between; gap:10px; margin-bottom:8px }
.drawerTitle{ font-weight:800; letter-spacing:.3px }
.closeBtn{ background:#1f1f1f; border:1px solid var(--stroke); color:#ddd; border-radius:10px; padding:8px 10px; cursor:pointer }

/* Playlist top tools */
.tools{ display:grid; grid-template-columns:1fr auto; gap:8px; margin:6px 0 10px }
.search{ background:#0f0f0f; border:1px solid var(--stroke); border-radius:10px; padding:8px 10px; color:#e5e7eb; outline:none }
.sortBtn{ background:#141414; border:1px solid var(--stroke); color:#ddd; border-radius:10px; padding:8px 10px; cursor:pointer }

.list{ max-height:420px; overflow:auto; display:grid; gap:6px }
.track{ display:grid; grid-template-columns:46px 1fr auto; gap:10px; align-items:center; padding:8px; border-radius:12px; cursor:pointer; background:#141414; border:1px solid transparent; transition:transform .12s ease, background .2s ease }
.track:hover{ background:#161616; border-color:#222; transform:translateY(-1px); }
.track.active{ background:linear-gradient(90deg, rgba(29,185,84,.22), rgba(30,215,96,.12)); border-color:rgba(29,185,84,.25) }
.thumb{ width:46px;height:46px;border-radius:10px; overflow:hidden } .thumb img{width:100%;height:100%;object-fit:cover}
.tmeta{ display:flex; flex-direction:column }
.tmeta .t{ font-weight:600; }
.tmeta .a{ font-size:.85rem; color:var(--muted) }
.small{ font-size:.78rem; color:var(--muted) }
.empty{ color:var(--muted); text-align:center; padding:12px 0 }

/* Drawer positioning (responsive slide) */
.sidebar{ position:relative; width:0; }
.drawerWrap{ position:relative; }
@media (min-width:900px){
  .drawerWrap { 
    position:relative; 
    width:380px; 
    height:100vh; /* full screen height */
    overflow:hidden; 
  }
  .drawer { 
    position:absolute; 
    right:0; 
    top:0; 
    width:380px; 
    height:100%; 
    display:flex; 
    flex-direction:column;
    background:#111; /* thoda dark background */
  }
  .drawer .playlist {
    flex:1; 
    overflow-y:auto;  /* scroll enable */
    padding:12px;
  }
  .drawerSlide { 
    transform:translateX(120%); 
    transition:transform .22s ease; 
  }
  .drawerSlide.open { 
    transform:translateX(0%); 
  }
}

@media (max-width:899.98px){
  .app{ grid-template-columns:1fr }
  .drawer{ position:fixed; left:50%; transform:translateX(-50%); bottom:12px; width:min(680px, 94vw); max-height:65vh }
  .drawerSlide{ transform:translateY(120%); transition:transform .24s ease }
  .drawerSlide.open{ transform:translateY(0%) }
}

/* responsive tweaks */
@media (max-width:600px){
  .art{ height:280px }
  .range{ width:130px }
  .title h1{ font-size:1.15rem }
}
</style>
</head>
<body>
<div class="blob g1"></div>
<div class="blob g2"></div>

<div class="app tilt" id="app">
  <!-- MAIN PANEL -->
  <div class="main">
    <div class="header">
      <div class="brand">
        <div class="logo">‚ô¨</div>
        <div>
          <div style="font-weight:800;letter-spacing:.3px">Music Player</div>
          <div class="small" style="color:var(--muted)">Enjoy Music</div>
        </div>
      </div>
      <button class="playlistBtn" id="toggleDrawer" title="Open Playlist">üìÉ Playlist</button>
    </div>

    <div class="art">
      <img id="coverImg" alt="cover" src="">
      <div class="vinyl" id="vinyl"></div>
      <div class="eq" id="eq"><span></span><span></span><span></span><span></span></div>
    </div>

    <div class="title">
      <div style="min-width:0">
        <h1 id="title">‚Äî</h1>
        <div class="meta" id="artist">‚Äî</div>
      </div>
      <div class="badge" id="status">READY</div>
    </div>

    <div class="seek" id="seek">
      <div class="progress" id="progress"></div>
      <div class="thumb" id="thumb"></div>
    </div>
    <div class="timeRow">
      <span id="cur">0:00</span>
      <span id="dur">0:00</span>
    </div>

    <div class="controls">
      <div class="btns">
        <button class="btn" id="prev" title="Previous (‚Üê)">‚èÆ</button>
        <button class="btn play" id="play" title="Play/Pause (Space)">
          <svg id="playIcon" viewBox="0 0 24 24" aria-hidden="true"><path d="M8 5v14l11-7z"></path></svg>
        </button>
        <button class="btn" id="next" title="Next (‚Üí)">‚è≠</button>
      </div>

      <div class="rightCtl">
        <div class="vol">
          <span>üîä</span>
          <input id="vol" class="range" type="range" min="0" max="1" step="0.01" value="0.9" />
        </div>
        <label class="tgl" title="Autoplay next">
          <input type="checkbox" id="autoplay" />
          <div class="switch"><div class="knob"></div></div>
          <span>Autoplay</span>
        </label>
      </div>
    </div>
  </div>

  <!-- SIDEBAR / DRAWER -->
  <div class="sidebar">
    <div class="drawerWrap">
      <div class="drawer drawerSlide" id="drawer">
        <div class="drawerHeader">
          <div class="drawerTitle">Playlist</div>
          <button class="closeBtn" id="closeDrawer">Close ‚úï</button>
        </div>
        <!-- playlist tools -->
        <div class="tools">
          <input class="search" id="search" placeholder="Search title or artist‚Ä¶" />
          <button class="sortBtn" id="sortBtn" title="Sort A‚ÜíZ">Sort A‚ÜíZ</button>
        </div>
        
        <div class="list" id="list"></div>
        <div class="empty" id="emptyMsg" style="display:none">No tracks found</div>
      </div>
    </div>
  </div>
</div>

<audio id="audio" preload="metadata"></audio>

<script>
/* ========= Your Tracks (change paths) ========= */
const TRACKS = [
  { title:"Silence",         artist:"Yung Sammy",   src:"silence.mp3",   cover:"images/kesariya.jpg",  duration:0 },
  { title:"Shakti aur Kshama",     artist:"Seedhe Maut",   src:"shaktiaurkshama.mp3",       cover:"images/apna.jpg",      duration:0 },
  { title:"Been a while",        artist:"Kr$na",   src:"Been a while.mp3",    cover:"images/tumhiho.jpg",   duration:0 },
  { title:"Knock Knock", artist:"Kr$na",  src:"Knock Knock.mp3",    cover:"images/raataan.jpg",   duration:0 },
   { title:"Hola Amigo",      artist:"Kr$na & Seedhe Maut",  src:"Holaamigo.mp3",    cover:"hola-amigo.webp",   duration:0 },
     { title:"Asal G",         artist:"Seedhe Maut",   src:"asal g.mp3",   cover:"images/kesariya.jpg",  duration:0 },
  { title:"Bhala Kyun",     artist:"DOTM",   src:"bhala kyun.mp3",       cover:"images/apna.jpg",      duration:0 },
  { title:"Khatta Flow",        artist:"Kr$na & Seedhe Maut",   src:"khatta flow.mp3",    cover:"images/tumhiho.jpg",   duration:0 },
  { title:"Together", artist:"Shubh",  src:"Together_1.mp3",    cover:"images/raataan.jpg",   duration:0 },
   { title:"woh Raat",      artist:"Kr$na & Raftar",  src:"Woh_Raat_1.mp3",    cover:"",   duration:0 },
];

/* ========= Elements ========= */
const app = document.getElementById('app');
const audio = document.getElementById('audio');
const cover = document.getElementById('coverImg');
const titleEl = document.getElementById('title');
const artistEl = document.getElementById('artist');
const statusEl = document.getElementById('status');
const progress = document.getElementById('progress');
const thumb = document.getElementById('thumb');
const cur = document.getElementById('cur');
const dur = document.getElementById('dur');
const seek = document.getElementById('seek');
const playBtn = document.getElementById('play');
const playIcon = document.getElementById('playIcon');
const prevBtn = document.getElementById('prev');
const nextBtn = document.getElementById('next');
const vol = document.getElementById('vol');
const autoplay = document.getElementById('autoplay');
const vinyl = document.getElementById('vinyl');
const eq = document.getElementById('eq');
const list = document.getElementById('list');
const drawer = document.getElementById('drawer');
const toggleDrawer = document.getElementById('toggleDrawer');
const closeDrawer = document.getElementById('closeDrawer');
const search = document.getElementById('search');
const sortBtn = document.getElementById('sortBtn');
const emptyMsg = document.getElementById('emptyMsg');

/* ========= State ========= */
let index = 0, scrubbing = false, asc = true;
const fmt = s => (!isFinite(s) ? "0:00" : `${Math.floor(s/60)}:${String(Math.floor(s%60)).padStart(2,'0')}`);
const setStatus = t => statusEl.textContent = t;
const save = (k,v)=> localStorage.setItem('sp_mp_'+k, JSON.stringify(v));
const load = (k,d)=> JSON.parse(localStorage.getItem('sp_mp_'+k) ?? JSON.stringify(d));

/* ========= Drawer handlers ========= */
const openDrawer  = () => drawer.classList.add('open');
const hideDrawer  = () => drawer.classList.remove('open');
 toggleDrawer.onclick = () => drawer.classList.toggle('open');
 closeDrawer.onclick = hideDrawer;

/* ========= Build playlist ========= */
function buildList(){
  list.innerHTML='';
  const q = search.value.trim().toLowerCase();
  const items = TRACKS.map((t,i)=>({...t, i}))
    .filter(t=> t.title.toLowerCase().includes(q) || t.artist.toLowerCase().includes(q))
    .sort((a,b)=> asc ? a.title.localeCompare(b.title) : b.title.localeCompare(a.title));

  emptyMsg.style.display = items.length ? 'none' : '';

  items.forEach((t)=>{
    const row = document.createElement('div');
    row.className = 'track';
    row.dataset.index = t.i;
    row.innerHTML = `
      <div class="thumb"><img src="${t.cover}" alt=""></div>
      <div class="tmeta">
        <div class="t">${t.title}</div>
        <div class="a">${t.artist}</div>
      </div>
      <div class="small" id="d-${t.i}">--:--</div>
    `;
    row.addEventListener('click', ()=>{
      loadTrack(t.i);
      // ensure play after metadata to avoid brief jump on mobile
      if (audio.readyState >= 2) play();
      else audio.addEventListener('canplay', play, {once:true});
    });
    list.appendChild(row);

    // Prefetch duration (once)
    if (!TRACKS[t.i].duration){
      const tmp = new Audio();
      tmp.src = t.src; tmp.preload = 'metadata';
      tmp.addEventListener('loadedmetadata', ()=>{
        TRACKS[t.i].duration = tmp.duration;
        const d = document.getElementById('d-'+t.i);
        if (d) d.textContent = fmt(TRACKS[t.i].duration);
      }, {once:true});
      tmp.addEventListener('error', ()=>{
        const d = document.getElementById('d-'+t.i);
        if (d) d.textContent = 'N/A';
      }, {once:true});
    } else {
      const d = document.getElementById('d-'+t.i);
      if (d) d.textContent = fmt(TRACKS[t.i].duration);
    }
  });

  // active highlight
  [...document.querySelectorAll('.track')].forEach(el=>{
    el.classList.toggle('active', +el.dataset.index === index);
  });
}

search.addEventListener('input', buildList);
sortBtn.addEventListener('click', ()=>{ asc = !asc; sortBtn.textContent = asc ? 'Sort A‚ÜíZ' : 'Sort Z‚ÜíA'; buildList(); });

/* ========= Load / Play / Pause ========= */
function swapIcon(isPlay){
  if (isPlay){ // show pause icon
    playIcon.innerHTML = '<path d="M6 19h4V5H6zm8-14v14h4V5z"></path>';
  } else {
    playIcon.innerHTML = '<path d="M8 5v14l11-7z"></path>';
  }
}

function loadTrack(i){
  index = (i + TRACKS.length) % TRACKS.length;
  const t = TRACKS[index];
  titleEl.textContent = t.title;
  artistEl.textContent = t.artist;
  // cover fade swap
  cover.classList.add('fade');
  const nextSrc = t.cover;
  if (cover.src !== location.origin + '/' + nextSrc){
    cover.addEventListener('load',()=> cover.classList.remove('fade'), {once:true});
    cover.src = nextSrc;
  } else {
    setTimeout(()=>cover.classList.remove('fade'), 200);
  }
  audio.src = t.src;
  progress.style.width='0%'; thumb.style.left='0%';
  cur.textContent='0:00'; dur.textContent='0:00';
  setStatus('READY'); eq.style.opacity=.8; vinyl.classList.remove('spin');
  // active highlight in list
  [...document.querySelectorAll('.track')].forEach(el=> el.classList.toggle('active', +el.dataset.index===index));
}

function play(){
  audio.play().then(()=>{
    swapIcon(true); vinyl.classList.add('spin'); eq.style.opacity=1; setStatus('PLAYING');
  }).catch(()=> setStatus('BLOCKED'));
}
function pause(){
  audio.pause(); swapIcon(false); vinyl.classList.remove('spin'); eq.style.opacity=.8; setStatus('PAUSED');
}

/* ========= Seek ========= */
const seekTo = clientX => {
  const r = seek.getBoundingClientRect();
  const pct = Math.min(1, Math.max(0, (clientX - r.left)/r.width));
  progress.style.width = pct*100+'%'; thumb.style.left = pct*100+'%';
  if (isFinite(audio.duration)) audio.currentTime = pct*audio.duration;
};
seek.addEventListener('pointerdown', e=>{ scrubbing=true; seek.setPointerCapture(e.pointerId); seekTo(e.clientX); });
seek.addEventListener('pointermove', e=>{ if(scrubbing) seekTo(e.clientX); });
seek.addEventListener('pointerup',   e=>{ if(scrubbing){ seekTo(e.clientX); scrubbing=false; }});

/* ========= Volume + Autoplay (persist) ========= */
vol.value = load('vol', 0.9); audio.volume = +vol.value;
vol.addEventListener('input', ()=>{ audio.volume = +vol.value; save('vol', vol.value); });
autoplay.checked = load('autoplay', true);
autoplay.addEventListener('change', ()=> save('autoplay', autoplay.checked));

/* ========= Buttons & Keys ========= */
playBtn.onclick = ()=> audio.paused ? play() : pause();
prevBtn.onclick = ()=>{ loadTrack(index-1); if (audio.readyState>=2) play(); else audio.addEventListener('canplay', play, {once:true}); };
nextBtn.onclick = ()=>{ loadTrack(index+1); if (audio.readyState>=2) play(); else audio.addEventListener('canplay', play, {once:true}); };
window.addEventListener('keydown', e=>{
  if (['INPUT','TEXTAREA','SELECT'].includes(document.activeElement.tagName)) return;
  if (e.code==='Space'){ e.preventDefault(); audio.paused ? play() : pause(); }
  if (e.key==='ArrowLeft'){ audio.currentTime = Math.max(0, audio.currentTime - 5); }
  if (e.key==='ArrowRight'){ audio.currentTime = Math.min(audio.duration||0, audio.currentTime + 5); }
});

/* ========= Audio events ========= */
audio.addEventListener('loadedmetadata', ()=>{ dur.textContent = fmt(audio.duration); });
audio.addEventListener('timeupdate', ()=>{
  const {currentTime, duration} = audio;
  if (isFinite(duration) && !scrubbing) {
    const pct = (currentTime/duration)*100;
    progress.style.width = pct+'%';
    thumb.style.left = pct+'%';
  }
  cur.textContent = fmt(currentTime);
});
audio.addEventListener('ended', ()=>{
  if (autoplay.checked){ loadTrack(index+1); if (audio.readyState>=2) play(); else audio.addEventListener('canplay', play, {once:true}); }
  else { pause(); setStatus('ENDED'); }
});
audio.addEventListener('error', ()=> setStatus('AUDIO ERR'));

/* ========= 3D tilt ========= */
app.addEventListener('mousemove', e=>{
  const r = app.getBoundingClientRect();
  const rx = ((e.clientY - r.top)/r.height -.5) * -6;
  const ry = ((e.clientX - r.left)/r.width -.5) * 8;
  app.style.transform = `rotateX(${rx}deg) rotateY(${ry}deg)`;
});
app.addEventListener('mouseleave', ()=> app.style.transform = 'rotateX(0deg) rotateY(0deg)');

/* ========= Init ========= */
buildList();
loadTrack(0);
setStatus('READY');
if (autoplay.checked) audio.addEventListener('canplay', play, {once:true});

/* little click glow on main buttons */
document.querySelectorAll('.btn, .playlistBtn, .closeBtn').forEach(b=>{
  b.addEventListener('click', ()=>{
    const fx=document.createElement('span');
    Object.assign(fx.style,{position:'absolute',inset:0,borderRadius:'inherit',
      boxShadow:'0 0 30px rgba(29,185,84,.35), inset 0 0 20px rgba(255,255,255,.08)',
      animation:'flash .35s ease',pointerEvents:'none'});
    b.style.position='relative'; b.appendChild(fx); setTimeout(()=>fx.remove(),350);
  });
});
const kf=document.createElement('style'); kf.textContent='@keyframes flash{from{opacity:.7}to{opacity:0}}'; document.head.appendChild(kf);
</script>
</body>
</html>